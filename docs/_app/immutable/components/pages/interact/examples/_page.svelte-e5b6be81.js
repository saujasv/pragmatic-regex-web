import{S as Se,i as Pe,s as je,k as f,q as k,a as P,w as Ne,l as d,m as _,r as I,h as a,c as j,x as De,n as g,b as Y,G as r,y as Ae,u as Z,f as He,t as Le,U as Ve,z as Ue,H as Ee,o as Be,e as we,I as te,B as he,p as ee,T as ke,L as Me,Q as Ye}from"../../../../chunks/index-0e9e634d.js";import{g as ce}from"../../../../chunks/navigation-c15f7844.js";import{u as Ce,o as Je}from"../../../../chunks/store-b95407d5.js";import{d as ue}from"../../../../chunks/singletons-69107a7c.js";import{S as xe}from"../../../../chunks/SvelteToast-ff19346a.js";import{t as ae}from"../../../../chunks/stores-3e1ed05a.js";function Ie(u,e,t){const l=u.slice();return l[23]=e[t],l}function Re(u){let e,t,l,s,c,o;return{c(){e=f("div"),t=f("h2"),l=k("You are now interacting with the "),s=f("span"),c=k("red"),o=k(" robot."),this.h()},l(i){e=d(i,"DIV",{});var n=_(e);t=d(n,"H2",{});var m=_(t);l=I(m,"You are now interacting with the "),s=d(m,"SPAN",{style:!0});var v=_(s);c=I(v,"red"),v.forEach(a),o=I(m," robot."),m.forEach(a),n.forEach(a),this.h()},h(){ee(s,"color","red")},m(i,n){Y(i,e,n),r(e,t),r(t,l),r(t,s),r(s,c),r(t,o)},d(i){i&&a(e)}}}function ze(u){let e,t,l,s,c,o;return{c(){e=f("div"),t=f("h2"),l=k("You are now interacting with the "),s=f("span"),c=k("blue"),o=k(" robot."),this.h()},l(i){e=d(i,"DIV",{});var n=_(e);t=d(n,"H2",{});var m=_(t);l=I(m,"You are now interacting with the "),s=d(m,"SPAN",{style:!0});var v=_(s);c=I(v,"blue"),v.forEach(a),o=I(m," robot."),m.forEach(a),n.forEach(a),this.h()},h(){ee(s,"color","blue")},m(i,n){Y(i,e,n),r(e,t),r(t,l),r(t,s),r(s,c),r(t,o)},d(i){i&&a(e)}}}function qe(u){let e,t,l,s,c,o;return{c(){e=f("div"),t=f("h2"),l=k("You are now interacting with the "),s=f("span"),c=k("green"),o=k(" robot."),this.h()},l(i){e=d(i,"DIV",{});var n=_(e);t=d(n,"H2",{});var m=_(t);l=I(m,"You are now interacting with the "),s=d(m,"SPAN",{style:!0});var v=_(s);c=I(v,"green"),v.forEach(a),o=I(m," robot."),m.forEach(a),n.forEach(a),this.h()},h(){ee(s,"color","green")},m(i,n){Y(i,e,n),r(e,t),r(t,l),r(t,s),r(s,c),r(t,o)},d(i){i&&a(e)}}}function Ge(u){let e,t,l,s,c;return{c(){e=f("div"),t=f("h2"),l=k("System's guess: "),s=f("tt"),c=k(u[6]),this.h()},l(o){e=d(o,"DIV",{class:!0});var i=_(e);t=d(i,"H2",{});var n=_(t);l=I(n,"System's guess: "),s=d(n,"TT",{style:!0});var m=_(s);c=I(m,u[6]),m.forEach(a),n.forEach(a),i.forEach(a),this.h()},h(){ee(s,"color","red"),g(e,"class","col-lg-10 py-md-3")},m(o,i){Y(o,e,i),r(e,t),r(t,l),r(t,s),r(s,c)},p(o,i){i&64&&Z(c,o[6])},d(o){o&&a(e)}}}function Xe(u){let e,t,l,s,c;return{c(){e=f("div"),t=f("h2"),l=k("System's guess: "),s=f("tt"),c=k(u[6]),this.h()},l(o){e=d(o,"DIV",{class:!0});var i=_(e);t=d(i,"H2",{});var n=_(t);l=I(n,"System's guess: "),s=d(n,"TT",{style:!0});var m=_(s);c=I(m,u[6]),m.forEach(a),n.forEach(a),i.forEach(a),this.h()},h(){ee(s,"color","green"),g(e,"class","col-lg-10 py-md-3")},m(o,i){Y(o,e,i),r(e,t),r(t,l),r(t,s),r(s,c)},p(o,i){i&64&&Z(c,o[6])},d(o){o&&a(e)}}}function Qe(u){let e,t,l,s,c,o,i,n,m,v,E,y,h,T,S,N,G,C,L,X,R,F;return{c(){e=f("div"),t=f("div"),l=f("span"),s=k("Enter example"),c=P(),o=f("input"),i=P(),n=f("input"),m=P(),v=f("label"),E=f("i"),y=P(),h=f("input"),T=P(),S=f("label"),N=f("i"),G=P(),C=f("div"),L=f("button"),X=k("Add"),this.h()},l(V){e=d(V,"DIV",{class:!0});var U=_(e);t=d(U,"DIV",{class:!0});var p=_(t);l=d(p,"SPAN",{class:!0});var D=_(l);s=I(D,"Enter example"),D.forEach(a),c=j(p),o=d(p,"INPUT",{type:!0,class:!0}),i=j(p),n=d(p,"INPUT",{type:!0,class:!0,name:!0,id:!0,autocomplete:!0}),m=j(p),v=d(p,"LABEL",{class:!0,for:!0});var H=_(v);E=d(H,"I",{class:!0}),_(E).forEach(a),H.forEach(a),y=j(p),h=d(p,"INPUT",{type:!0,class:!0,name:!0,id:!0,autocomplete:!0}),T=j(p),S=d(p,"LABEL",{class:!0,for:!0});var O=_(S);N=d(O,"I",{class:!0}),_(N).forEach(a),O.forEach(a),p.forEach(a),G=j(U),C=d(U,"DIV",{class:!0});var Q=_(C);L=d(Q,"BUTTON",{type:!0,class:!0});var J=_(L);X=I(J,"Add"),J.forEach(a),Q.forEach(a),U.forEach(a),this.h()},h(){g(l,"class","input-group-text"),g(o,"type","text"),g(o,"class","form-control"),g(n,"type","radio"),g(n,"class","btn-check"),g(n,"name","utterance-type"),n.__value="+",n.value=n.__value,g(n,"id","positive"),g(n,"autocomplete","off"),u[13][0].push(n),g(E,"class","fa-solid fa-plus"),g(v,"class","btn btn-outline-primary"),g(v,"for","positive"),g(h,"type","radio"),g(h,"class","btn-check"),g(h,"name","utterance-type"),h.__value="-",h.value=h.__value,g(h,"id","negative"),g(h,"autocomplete","off"),u[13][0].push(h),g(N,"class","fa-solid fa-minus"),g(S,"class","btn btn-outline-danger"),g(S,"for","negative"),g(t,"class","input-group col"),g(L,"type","submit"),g(L,"class","btn btn-primary col-auto"),g(C,"class","col"),g(e,"class","row gx-1")},m(V,U){Y(V,e,U),r(e,t),r(t,l),r(l,s),r(t,c),r(t,o),ke(o,u[3]),r(t,i),r(t,n),n.checked=n.__value===u[4],r(t,m),r(t,v),r(v,E),r(t,y),r(t,h),h.checked=h.__value===u[4],r(t,T),r(t,S),r(S,N),r(e,G),r(e,C),r(C,L),r(L,X),R||(F=[te(o,"input",u[11]),te(n,"change",u[12]),te(h,"change",u[14]),te(L,"click",u[9])],R=!0)},p(V,U){U&8&&o.value!==V[3]&&ke(o,V[3]),U&16&&(n.checked=n.__value===V[4]),U&16&&(h.checked=h.__value===V[4])},d(V){V&&a(e),u[13][0].splice(u[13][0].indexOf(n),1),u[13][0].splice(u[13][0].indexOf(h),1),R=!1,Me(F)}}}function Fe(u){let e,t;return{c(){e=f("h2"),t=k("Succeeded, scroll to the end and submit!"),this.h()},l(l){e=d(l,"H2",{style:!0});var s=_(e);t=I(s,"Succeeded, scroll to the end and submit!"),s.forEach(a),this.h()},h(){ee(e,"color","green")},m(l,s){Y(l,e,s),r(e,t)},p:he,d(l){l&&a(e)}}}function Ke(u){let e,t,l=u[23].string+"",s,c,o,i,n,m,v,E;return{c(){e=f("div"),t=f("li"),s=k(l),c=P(),o=f("li"),i=f("i"),n=P(),m=f("li"),v=f("i"),E=P(),this.h()},l(y){e=d(y,"DIV",{class:!0});var h=_(e);t=d(h,"LI",{class:!0});var T=_(t);s=I(T,l),T.forEach(a),c=j(h),o=d(h,"LI",{class:!0});var S=_(o);i=d(S,"I",{class:!0}),_(i).forEach(a),S.forEach(a),n=j(h),m=d(h,"LI",{class:!0});var N=_(m);v=d(N,"I",{class:!0}),_(v).forEach(a),N.forEach(a),h.forEach(a),E=j(y),this.h()},h(){g(t,"class","list-group-item list-group-item flex-fill"),g(i,"class","fa-solid fa-plus"),g(o,"class","list-group-item list-group-item"),g(v,"class","fa-solid fa-minus"),g(m,"class","list-group-item list-group-item-danger"),g(e,"class","list-group list-group-horizontal py-md-1")},m(y,h){Y(y,e,h),r(e,t),r(t,s),r(e,c),r(e,o),r(o,i),r(e,n),r(e,m),r(m,v),Y(y,E,h)},p(y,h){h&32&&l!==(l=y[23].string+"")&&Z(s,l)},d(y){y&&a(e),y&&a(E)}}}function We(u){let e,t,l=u[23].string+"",s,c,o,i,n,m,v,E;return{c(){e=f("div"),t=f("li"),s=k(l),c=P(),o=f("li"),i=f("i"),n=P(),m=f("li"),v=f("i"),E=P(),this.h()},l(y){e=d(y,"DIV",{class:!0});var h=_(e);t=d(h,"LI",{class:!0});var T=_(t);s=I(T,l),T.forEach(a),c=j(h),o=d(h,"LI",{class:!0});var S=_(o);i=d(S,"I",{class:!0}),_(i).forEach(a),S.forEach(a),n=j(h),m=d(h,"LI",{class:!0});var N=_(m);v=d(N,"I",{class:!0}),_(v).forEach(a),N.forEach(a),h.forEach(a),E=j(y),this.h()},h(){g(t,"class","list-group-item list-group-item flex-fill"),g(i,"class","fa-solid fa-plus"),g(o,"class","list-group-item list-group-item-primary"),g(v,"class","fa-solid fa-minus"),g(m,"class","list-group-item list-group-item"),g(e,"class","list-group list-group-horizontal py-md-1")},m(y,h){Y(y,e,h),r(e,t),r(t,s),r(e,c),r(e,o),r(o,i),r(e,n),r(e,m),r(m,v),Y(y,E,h)},p(y,h){h&32&&l!==(l=y[23].string+"")&&Z(s,l)},d(y){y&&a(e),y&&a(E)}}}function Te(u){let e;function t(c,o){if(c[23].label=="+")return We;if(c[23].label=="-")return Ke}let l=t(u),s=l&&l(u);return{c(){s&&s.c(),e=we()},l(c){s&&s.l(c),e=we()},m(c,o){s&&s.m(c,o),Y(c,e,o)},p(c,o){l===(l=t(c))&&s?s.p(c,o):(s&&s.d(1),s=l&&l(c),s&&(s.c(),s.m(e.parentNode,e)))},d(c){s&&s.d(c),c&&a(e)}}}function Oe(u){let e,t,l,s,c;return{c(){e=f("div"),t=f("button"),l=k("Submit"),this.h()},l(o){e=d(o,"DIV",{class:!0});var i=_(e);t=d(i,"BUTTON",{class:!0});var n=_(t);l=I(n,"Submit"),n.forEach(a),i.forEach(a),this.h()},h(){g(t,"class","btn btn-success btn-lg float-end"),g(e,"class","col-lg-6 py-md-5")},m(o,i){Y(o,e,i),r(e,t),r(t,l),s||(c=te(t,"click",u[10]),s=!0)},p:he,d(o){o&&a(e),s=!1,c()}}}function Ze(u){let e,t,l,s,c,o,i,n,m,v,E,y,h,T,S,N,G,C,L,X,R,F,V,U,p,D,H,O,Q,J,x;function se(b,w){return(b[1]+b[8])%3==0?qe:(b[1]+b[8])%3==1?ze:Re}let re=se(u),K=re(u);function fe(b,w){return b[7]?Xe:Ge}let le=fe(u),z=le(u);function de(b,w){return b[7]?Fe:Qe}let oe=de(u),q=oe(u),$=u[5],B=[];for(let b=0;b<$.length;b+=1)B[b]=Te(Ie(u,$,b));let M=(u[5].length>=10||u[7])&&Oe(u);return J=new xe({}),{c(){e=f("div"),t=f("div"),l=f("h4"),s=k("Completed "),c=k(u[1]),o=k(" of "),i=k(u[0]),n=k(" tasks"),m=P(),v=f("div"),E=f("h2"),y=k("You are now the describer"),h=P(),T=f("p"),S=k(`Here, you are presented with a regular expression. You need to interact with a system and communicate the regular expression. After each example is provided, a system that is playing the role of a guesser will guess which regular expression you might have been referring to. The game is completed when the system's guess matches the regular expression you were given, or when 10 examples have been provided. If the system produces "null" as a guess, then the system failed to guess the regular expression. You can provide more examples, which might help the system, and if the system fails to guess the regular expression after 10 examples, you can submit the examples you provided and move on to the next task.`),N=P(),K.c(),G=P(),C=f("div"),L=f("h2"),X=k("Regex: "),R=f("tt"),F=k(u[2]),V=P(),z.c(),U=P(),q.c(),p=P(),D=f("div"),H=f("ul");for(let b=0;b<B.length;b+=1)B[b].c();O=P(),M&&M.c(),Q=P(),Ne(J.$$.fragment),this.h()},l(b){e=d(b,"DIV",{class:!0});var w=_(e);t=d(w,"DIV",{class:!0});var A=_(t);l=d(A,"H4",{});var W=_(l);s=I(W,"Completed "),c=I(W,u[1]),o=I(W," of "),i=I(W,u[0]),n=I(W," tasks"),W.forEach(a),A.forEach(a),m=j(w),v=d(w,"DIV",{class:!0});var pe=_(v);E=d(pe,"H2",{});var me=_(E);y=I(me,"You are now the describer"),me.forEach(a),pe.forEach(a),h=j(w),T=d(w,"P",{});var _e=_(T);S=I(_e,`Here, you are presented with a regular expression. You need to interact with a system and communicate the regular expression. After each example is provided, a system that is playing the role of a guesser will guess which regular expression you might have been referring to. The game is completed when the system's guess matches the regular expression you were given, or when 10 examples have been provided. If the system produces "null" as a guess, then the system failed to guess the regular expression. You can provide more examples, which might help the system, and if the system fails to guess the regular expression after 10 examples, you can submit the examples you provided and move on to the next task.`),_e.forEach(a),N=j(w),K.l(w),G=j(w),C=d(w,"DIV",{class:!0});var ge=_(C);L=d(ge,"H2",{});var ne=_(L);X=I(ne,"Regex: "),R=d(ne,"TT",{});var be=_(R);F=I(be,u[2]),be.forEach(a),ne.forEach(a),ge.forEach(a),V=j(w),z.l(w),U=j(w),q.l(w),p=j(w),D=d(w,"DIV",{class:!0});var ve=_(D);H=d(ve,"UL",{class:!0});var ye=_(H);for(let ie=0;ie<B.length;ie+=1)B[ie].l(ye);ye.forEach(a),ve.forEach(a),O=j(w),M&&M.l(w),Q=j(w),De(J.$$.fragment,w),w.forEach(a),this.h()},h(){g(t,"class","col-lg-10 pt-md-1 pb-md-1 text-center"),g(v,"class","col-lg-10 pt-md-1 pb-md-1 text-center"),g(C,"class","col-lg-10 py-md-3"),g(H,"class","list-group"),g(D,"class","col-lg-6 py-md-5"),g(e,"class","col-lg-10 mx-auto p-3 py-md-5")},m(b,w){Y(b,e,w),r(e,t),r(t,l),r(l,s),r(l,c),r(l,o),r(l,i),r(l,n),r(e,m),r(e,v),r(v,E),r(E,y),r(e,h),r(e,T),r(T,S),r(e,N),K.m(e,null),r(e,G),r(e,C),r(C,L),r(L,X),r(L,R),r(R,F),r(e,V),z.m(e,null),r(e,U),q.m(e,null),r(e,p),r(e,D),r(D,H);for(let A=0;A<B.length;A+=1)B[A].m(H,null);r(e,O),M&&M.m(e,null),r(e,Q),Ae(J,e,null),x=!0},p(b,[w]){if((!x||w&2)&&Z(c,b[1]),(!x||w&1)&&Z(i,b[0]),re!==(re=se(b))&&(K.d(1),K=re(b),K&&(K.c(),K.m(e,G))),(!x||w&4)&&Z(F,b[2]),le===(le=fe(b))&&z?z.p(b,w):(z.d(1),z=le(b),z&&(z.c(),z.m(e,U))),oe===(oe=de(b))&&q?q.p(b,w):(q.d(1),q=oe(b),q&&(q.c(),q.m(e,p))),w&32){$=b[5];let A;for(A=0;A<$.length;A+=1){const W=Ie(b,$,A);B[A]?B[A].p(W,w):(B[A]=Te(W),B[A].c(),B[A].m(H,null))}for(;A<B.length;A+=1)B[A].d(1);B.length=$.length}b[5].length>=10||b[7]?M?M.p(b,w):(M=Oe(b),M.c(),M.m(e,Q)):M&&(M.d(1),M=null)},i(b){x||(He(J.$$.fragment,b),x=!0)},o(b){Le(J.$$.fragment,b),x=!1},d(b){b&&a(e),K.d(),z.d(),q.d(),Ve(B,b),M&&M.d(),Ue(J)}}}function $e(u,e){return u=Math.ceil(u),e=Math.floor(e),Math.floor(Math.random()*(e-u)+u)}function et(u,e,t){let l,s;Ee(u,Ce,p=>t(19,l=p)),Ee(u,Je,p=>t(8,s=p));let c=[],o=1,i=30,n=0,m="",v="",E="",y=null,h=[],T="",S=!1,N=0;function G(){if(c=[...c,{string:E,label:y,id:N}],E.length>0)if(y===null){ae.push("Label not provided",{theme:{"--toastBarHeight":0,"--toastBackground":"red"}});return}else{for(var p of h)if(E==p.string){ae.push("This example has already been provided",{theme:{"--toastBarHeight":0,"--toastBackground":"red"}});return}if(y=="+"&&E.match(`^${m}$`))t(5,h=[...h,{string:E,label:y,id:N}]),t(3,E=""),t(4,y=null),N+=1;else if(y=="-"&&!E.match(`^${m}$`))t(5,h=[...h,{string:E,label:y,id:N}]),t(3,E=""),t(4,y=null),N+=1;else{ae.push("Label does not match string",{theme:{"--toastBarHeight":0,"--toastBackground":"red"}});return}}else{ae.push("Please enter a valid string",{theme:{"--toastBarHeight":0,"--toastBackground":"red"}});return}C()}async function C(){if((n+s)%3==0){t(6,T="...");let p=await fetch("https://sqv1rlpqi9lshx3r.us-east-1.aws.endpoints.huggingface.cloud",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputs:{true_program:m,spec:h}})}).then(D=>D.json());p&&(p.guess?t(6,T=p.guess):t(6,T="<regex not found>"),p.top_1_success&&t(7,S=!0),await fetch(`https://regex-interact-default-rtdb.firebaseio.com/user_study/${v}/interaction/${l}/${h.length}.json`,{method:"PUT",body:JSON.stringify({listener_idx:(n+s)%3,listener:"pragmatic",response:p})}))}else if((n+s)%3==1){t(6,T="...");let p=await fetch("https://c0vmrzlr7laeho8b.us-east-1.aws.endpoints.huggingface.cloud",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputs:{true_program:m,spec:h}})}).then(D=>D.json());p&&(p.guess?t(6,T=p.guess):t(6,T="<regex not found>"),p.top_1_success&&t(7,S=!0),await fetch(`https://regex-interact-default-rtdb.firebaseio.com/user_study/${v}/interaction/${l}/${h.length}.json`,{method:"PUT",body:JSON.stringify({listener_idx:(n+s)%3,listener:"literal",response:p})}))}else{t(6,T="...");let p=await fetch("https://fa096oepnph7ti6r.us-east-1.aws.endpoints.huggingface.cloud",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputs:{true_program:m,spec:h}})}).then(D=>D.json());p&&(p.guess?t(6,T=p.guess):t(6,T="<regex not found>"),p.top_1_success&&t(7,S=!0),await fetch(`https://regex-interact-default-rtdb.firebaseio.com/user_study/${v}/interaction/${l}/${h.length}.json`,{method:"PUT",body:JSON.stringify({listener_idx:(n+s)%3,listener:"hft",response:p})}))}}async function L(){console.log(v),await fetch(`https://regex-interact-default-rtdb.firebaseio.com/user_study/${v}/interaction/${l}/full_spec.json`,{method:"PUT",body:JSON.stringify(h)}),await fetch(`https://regex-interact-default-rtdb.firebaseio.com/user_study/${v}/interaction/${l}/completed.json`,{method:"PUT",body:JSON.stringify(!0)}),t(5,h=[]),await X().then(p=>{})}async function X(){l.length==0&&ce(`${ue}/interact/login`);let p=await fetch("https://regex-interact-default-rtdb.firebaseio.com/user_study.json").then(x=>x.json()),D=new Object,H=new Object;for(var O in p)if(p[O].hasOwnProperty("interaction")){let x=!1;p[O].interaction.hasOwnProperty(l)&&p[O].interaction[l].hasOwnProperty("completed")&&p[O].interaction[l].completed&&(x=!0),p[O].interaction.hasOwnProperty(l)&&x&&(D[O]=p[O]),Object.keys(p[O].interaction).length<o&&(H[O]=p[O])}else H[O]=p[O];Object.keys(D).length>i&&ce(`${ue}/interact/finish`),Object.keys(H).length==0&&ce(`${ue}/interact/finish`),t(1,n=Object.keys(D).length),console.log("COMPLETED"),console.log(n);let Q=$e(0,Object.keys(H).length);console.log(Q);let J=0;for(var O in H){if(J==Q){v=O,t(2,m=H[O].program),console.log(O,H[O]),console.log(v,m),await fetch(`https://regex-interact-default-rtdb.firebaseio.com/user_study/${v}/interaction/${l}/completed.json`,{method:"PUT",body:JSON.stringify(!1)}).then(se=>se.json()),t(6,T=""),t(7,S=!1);return}J+=1}}Be(X);const R=[[]];function F(){E=this.value,t(3,E)}function V(){y=this.__value,t(4,y)}function U(){y=this.__value,t(4,y)}return[i,n,m,E,y,h,T,S,s,G,L,F,V,R,U]}class tt extends Se{constructor(e){super(),Pe(this,e,et,Ze,je,{})}}function st(u){let e,t,l,s,c;return s=new tt({}),{c(){e=f("meta"),t=P(),l=f("main"),Ne(s.$$.fragment),this.h()},l(o){const i=Ye("svelte-jy85c7",document.head);e=d(i,"META",{name:!0,content:!0}),i.forEach(a),t=j(o),l=d(o,"MAIN",{});var n=_(l);De(s.$$.fragment,n),n.forEach(a),this.h()},h(){document.title="Regex from Examples",g(e,"name","description"),g(e,"content","Collect examples of examples used to communicate about regexes")},m(o,i){r(document.head,e),Y(o,t,i),Y(o,l,i),Ae(s,l,null),c=!0},p:he,i(o){c||(He(s.$$.fragment,o),c=!0)},o(o){Le(s.$$.fragment,o),c=!1},d(o){a(e),o&&a(t),o&&a(l),Ue(s)}}}class ct extends Se{constructor(e){super(),Pe(this,e,null,st,je,{})}}export{ct as default};
